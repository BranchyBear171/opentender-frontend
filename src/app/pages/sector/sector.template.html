<section class="container-outer authority entity" *ngIf="!sector">
	<section class="container">
		<div class="entity-title">Sector</div>
		<div *ngIf="error">Error: {{error}}</div>
		<div *ngIf="!error">Loading...</div>
	</section>
</section>
<section class="container-outer sector entity" *ngIf="sector">
	<section class="container">
		<div class="entity-title"><i class="icon-hammer icon-large"></i> Sector</div>
		<h1>{{sector.name}}</h1>

	</section>

	<section class="container container-margin">
		<h2>Indicators</h2>
		<div class="container slab-beta-light container-padded-large">
			<div class="container">
				<div class="container-left-6" *ngIf="charts.lots_in_years.visible">
					<div class="title">Number of Contract Lots per Year</div>
					<ngx-charts-bar-vertical
							class="chart-container"
							[chart]="charts.lots_in_years.chart"
							[data]="charts.lots_in_years.data"
							(select)="charts.lots_in_years.select($event)"
							(legendLabelClick)="charts.lots_in_years.onLegendLabelClick($event)">
					</ngx-charts-bar-vertical>
				</div>
				<div class="container-left-6">
					<div *ngIf="parent_sector">
						<div class="title">Group:</div>
						<a [routerLink]="'/sector/'+parent_sector.id">{{parent_sector.name}}</a>
					</div>
					<div *ngIf="!parent_sector && charts.cpvs_codes.visible">
						<div class="title">Structure of Sector (CPV)</div>
						<ngx-charts-pie-chart
								class="chart-container"
								[chart]="charts.cpvs_codes.chart"
								[data]="charts.cpvs_codes.data"
								(legendLabelClick)="charts.cpvs_codes.onLegendLabelClick($event)"
								(select)="charts.cpvs_codes.select($event)">
						</ngx-charts-pie-chart>
					</div>
				</div>
			</div>
			<div class="container">
				<div class="container-left-6">
					<div class="title">Total Number of Contracts</div>
					<div class="stats">
						<ul>
							<li><span>Tenders</span><span>{{vis.tenders_total | formatNumber}}</span></li>
							<li><span>Lots</span><span>{{vis.lots_total | formatNumber}}</span></li>
							<li><span>Bids</span><span>{{vis.bids_total | formatNumber}}</span></li>
							<li><span>Bids awarded</span><span>{{vis.bids_awarded | formatNumber}}</span></li>
						</ul>
					</div>
				</div>
				<div class="container-left-6">
					<div class="title">Total Contract Value <i class="icon-info" ngx-tooltip [tooltipTitle]="'Net amount of the tender final price is used to calculate the sum'"></i></div>
					<div *ngFor="let val of vis.sum_prices">
						<span class="currency-prefix">{{val.currency | formatCurrency}}</span> <span>{{val.value | formatCurrencyValue}}</span>
					</div>
				</div>
			</div>
		</div>
	</section>
	<section class="container container-margin">
		<div class="container">
			<div class="container-left-6">
				<h2>Main suppliers</h2>
				<table class="tables">
					<tr>
						<th>Supplier</th>
						<th>Tenders</th>
					</tr>
					<tr *ngFor="let val of vis.suppliers">
						<td>
							<tender-body-line [body]="val.body" [link]="'/company/'+val.body.groupId"></tender-body-line>
						</td>
						<td>{{val.value| formatNumber}}</td>
					</tr>
				</table>
			</div>
			<div class="container-left-6">
				<h2>Main buyers</h2>
				<table class="tables">
					<tr>
						<th>Buyer</th>
						<th>Tenders</th>
					</tr>
					<tr *ngFor="let val of vis.buyers">
						<td>
							<tender-body-line [body]="val.body" [link]="'/authority/'+val.body.groupId"></tender-body-line>
						</td>
						<td>{{val.value| formatNumber}}</td>
					</tr>
				</table>
			</div>
		</div>
		<div class="container">
			<div class="container-left-6" *ngIf="vis.subgroups && vis.subgroups.length>0">
				<h2>Subgroups</h2>
				<table class="tables">
					<tr>
						<th>Subgroup</th>
						<th>Tenders</th>
					</tr>
					<tr *ngFor="let val of vis.subgroups">
						<td>
							<a [routerLink]="'/sector/'+val.id">{{val.name}}</a>
						</td>
						<td>{{val.value| formatNumber}}</td>
					</tr>
				</table>
			</div>
			<div class="container-left-6">
			</div>
		</div>
	</section>

	<section class="container">
		<tender-table [search_cmd]="search_cmd" [columnIds]="columnIds" [title]="'Tenders'" (searchChange)="searchChange($event);"></tender-table>
	</section>
</section>
